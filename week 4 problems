II. Write nested queries for answering the following queries that retrieve data from
university database:
1. Find the total number of (distinct) students who have taken course
sections taught by the instructor with ID 110011
SQL>select count(distinct id) from (select ta.id from teaches t,takes ta,course c where t.course_id=c.course_id and t.course_id=ta.course_id and t.id='110011');
COUNT(DISTINCTID)
-----------------
                0




2. Find the names of all instructors whose salary is greater than at least one
instructor in the Biology department
SQL> select name from (select i1.name from instructor i1,instructor i2 where i1.salary>i2.salary and
 i2.dept_name='Biology');

NAME
--------------------
Wu
Einstein
Gold
Katz
Singh
Brandt
Kim

7 rows selected.




3. Find the departments that have the highest average salary.
SQL> SELECT dept_name FROM instructor GROUP BY dept_name having avg(salary)=(SELECT max(avg(salary)) FROM instructor GROUP BY dept_name);

DEPT_NAME
--------------------
Physics




4. Find all the courses taught in the both the Fall 2009 and Spring 2010
semesters





5. Find all the courses taught in the Fall 2009 semester but not in the Spring
2010 semester.





6. Find all courses taught in both the Fall 2009 semester and in the Spring
2010 semester. (Write correlated nested Query)





7. Find all students who have taken all courses offered in the Biology
department. (Write Correlated nested Query)





8. Find all courses that were offered at most once in 2009.





9. Find all courses that were offered at least twice in 2009”





10. Find the average instructors’ salaries of those departments where the
average salary is greater than $42,000.




11. Find the departments with the maximum budget.
SQL> select dept_name from department where budget in (select max(budget) from department);

DEPT_NAME
--------------------
Finance



12. Find the names of instructors who have not taught any course.




13. Find the IDs and names of all students who have not taken any course
offering before Spring 2009.




14. Find the lowest, across all departments, of the per-department maximum
salary computed.




